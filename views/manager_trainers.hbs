<!DOCTYPE html>
<html lang="uk">
<head>
    <title>–ö–µ—Ä—É–≤–∞–Ω–Ω—è —Ç—Ä–µ–Ω–µ—Ä–∞–º–∏</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body class="bg-light d-flex flex-column min-vh-100">

    {{> menu}}

    <div class="container mt-4">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>–ë–∞–∑–∞ —Ç—Ä–µ–Ω–µ—Ä—ñ–≤</h2>
            <button class="btn btn-success shadow" data-bs-toggle="modal" data-bs-target="#addTrainerModal">
                + –ù–æ–≤–∏–π —Ç—Ä–µ–Ω–µ—Ä
            </button>
        </div>
        <div class="card shadow-sm border-0">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-dark">
                            <tr>
                                <th class="ps-4">–§–æ—Ç–æ</th> <th>–Ü–º'—è</th>
                                <th>–ö–æ–Ω—Ç–∞–∫—Ç–∏</th>
                                <th>–î–æ—Å–≤—ñ–¥</th>
                                <th class="text-end pe-4">–î—ñ—ó</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each trainers}}
                            <tr>
                                <td class="ps-4">
                                    {{#if this.photo}}
                                        <img src="/trainer/image/{{this.id}}" alt="photo" class="rounded-circle" style="width: 50px; height: 50px; object-fit: cover;">
                                    {{else}}
                                        <div class="rounded-circle bg-secondary d-flex align-items-center justify-content-center text-white" style="width: 50px; height: 50px;">üì∑</div>
                                    {{/if}}
                                </td>
                                <td class="fw-bold">{{this.full_name}}</td>
                                <td>
                                    <div>üìß {{this.email}}</div>
                                    <div class="small text-muted">üì± {{this.phone}}</div>
                                </td>
                                <td>{{this.experience}} —Ä–æ–∫—ñ–≤</td>
                                <td class="text-end pe-4">
                                    <button class="btn btn-sm btn-outline-primary me-1" 
                                            data-id="{{this.id}}" 
                                            data-name="{{this.full_name}}" 
                                            data-email="{{this.email}}" 
                                            data-phone="{{this.phone}}"
                                            data-exp="{{this.experience}}"
                                            data-desc="{{this.description}}"
                                            onclick="openEditTrainerModal(this)">
                                        ‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏
                                    </button>
                                    <form action="/manager/trainers/delete" method="POST" class="d-inline" onsubmit="return confirm('–í–∏–¥–∞–ª–∏—Ç–∏ —Ü—å–æ–≥–æ —Ç—Ä–µ–Ω–µ—Ä–∞?')">
                                        <input type="hidden" name="id" value="{{this.id}}">
                                        <button type="submit" class="btn btn-sm btn-outline-danger">üóëÔ∏è</button>
                                    </form>
                                </td>
                            </tr>
                            {{/each}}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="addTrainerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title">–ù–æ–≤–∏–π —Ç—Ä–µ–Ω–µ—Ä</h5>
                    <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form action="/manager/trainers/add" method="POST" enctype="multipart/form-data">
                        <div class="mb-3 text-center">
                            <label class="form-label fw-bold">–§–æ—Ç–æ –ø—Ä–æ—Ñ—ñ–ª—é</label>
                            <input type="file" name="photo" class="form-control" accept="image/*">
                        </div>
                        <div class="mb-2"><label>–ü–Ü–ë</label><input type="text" name="full_name" class="form-control" required></div>
                        <div class="mb-2"><label>Email (–õ–æ–≥—ñ–Ω)</label><input type="email" name="email" class="form-control" required></div>
                        <div class="mb-2"><label>–¢–µ–ª–µ—Ñ–æ–Ω</label><input type="text" name="phone" class="form-control" required></div>
                        <div class="row mb-2">
                            <div class="col-4"><label>–î–æ—Å–≤—ñ–¥ (—Ä–æ–∫—ñ–≤)</label><input type="number" name="experience" class="form-control" required></div>
                            <div class="col-8">
                                <label>–ü–∞—Ä–æ–ª—å</label>
                                <input type="text" name="password" class="form-control" required placeholder="–°—Ç–≤–æ—Ä—ñ—Ç—å –ø–∞—Ä–æ–ª—å...">
                            </div>
                        </div>
                        <div class="mb-3"><label>–û–ø–∏—Å</label><textarea name="description" class="form-control" rows="2"></textarea></div>
                        <button type="submit" class="btn btn-success w-100">–°—Ç–≤–æ—Ä–∏—Ç–∏</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="editTrainerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title">–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ç—Ä–µ–Ω–µ—Ä–∞</h5>
                    <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form action="/manager/trainers/edit" method="POST" enctype="multipart/form-data">
                        <input type="hidden" name="id" id="editId">
                        <div class="mb-3 p-3 bg-light rounded text-center">
                            <label class="form-label small text-muted">–ó–º—ñ–Ω–∏—Ç–∏ —Ñ–æ—Ç–æ (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)</label>
                            <input type="file" name="photo" class="form-control form-control-sm" accept="image/*">
                        </div>
                        <div class="mb-2"><label>–ü–Ü–ë</label><input type="text" name="full_name" id="editName" class="form-control" required></div>
                        <div class="mb-2"><label>Email</label><input type="email" name="email" id="editEmail" class="form-control" required></div>
                        <div class="mb-2"><label>–¢–µ–ª–µ—Ñ–æ–Ω</label><input type="text" name="phone" id="editPhone" class="form-control" required></div>
                        <div class="mb-2"><label>–î–æ—Å–≤—ñ–¥</label><input type="number" name="experience" id="editExp" class="form-control" required></div>
                        <div class="mb-3"><label>–û–ø–∏—Å</label><textarea name="description" id="editDesc" class="form-control" rows="2"></textarea></div>
                        <hr>
                        <div class="mb-3">
                            <label class="fw-bold text-danger">–ó–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–æ–ª—å (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)</label>
                            <input type="text" name="new_password" class="form-control" placeholder="–ó–∞–ª–∏—à—Ç–µ –ø—É—Å—Ç–∏–º, —è–∫—â–æ –Ω–µ –∑–º—ñ–Ω—é—î—Ç–µ">
                        </div>
                        <button type="submit" class="btn btn-success w-100">–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    {{> footer}}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function openEditTrainerModal(btn) {
            document.getElementById('editId').value = btn.dataset.id;
            document.getElementById('editName').value = btn.dataset.name;
            document.getElementById('editEmail').value = btn.dataset.email;
            document.getElementById('editPhone').value = btn.dataset.phone;
            document.getElementById('editExp').value = btn.dataset.exp;
            document.getElementById('editDesc').value = btn.dataset.desc;
            new bootstrap.Modal(document.getElementById('editTrainerModal')).show();
        }
    </script>
</body>
</html>